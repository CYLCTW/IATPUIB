## Подготовка данных 1. Импортируйте данные DNS

    library(dplyr)

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

    inf = read.csv("dns.log", header = FALSE,sep = "\t",encoding = "UTF-8")

## 2. Добавьте пропущенные данные о структуре данных (назначении столбцов)

    head=read.csv("header.csv", header = TRUE)
    field<-head[,1]
    inf = read.csv("dns.log", header = FALSE,sep = "\t",encoding = "UTF-8")
    names(inf)<-field

## 3. Преобразуйте данные в столбцах в нужный формат

## Анализ 4. Сколько участников информационного обмена в сети Доброй Организации?

    orig_ip<-unique(inf$`orig_ip `)
    orig_ip

    ##   [1] "192.168.202.100"                     
    ##   [2] "192.168.202.76"                      
    ##   [3] "192.168.202.89"                      
    ##   [4] "192.168.202.85"                      
    ##   [5] "192.168.202.102"                     
    ##   [6] "192.168.202.93"                      
    ##   [7] "192.168.202.97"                      
    ##   [8] "fe80::ba8d:12ff:fe53:a8d8"           
    ##   [9] "192.168.202.71"                      
    ##  [10] "192.168.202.77"                      
    ##  [11] "2001:dbb:c18:202:f2de:f1ff:fe9b:ad6a"
    ##  [12] "192.168.202.79"                      
    ##  [13] "192.168.202.87"                      
    ##  [14] "192.168.204.69"                      
    ##  [15] "192.168.202.65"                      
    ##  [16] "192.168.202.94"                      
    ##  [17] "fe80::223:dfff:fe97:4e12"            
    ##  [18] "192.168.202.80"                      
    ##  [19] "fe80::c62c:3ff:fe37:efc"             
    ##  [20] "192.168.202.88"                      
    ##  [21] "192.168.202.84"                      
    ##  [22] "192.168.204.59"                      
    ##  [23] "192.168.202.92"                      
    ##  [24] "fe80::3e07:54ff:fe1c:a665"           
    ##  [25] "192.168.202.78"                      
    ##  [26] "192.168.207.4"                       
    ##  [27] "192.168.205.253"                     
    ##  [28] "2001:dbb:c18:202:20c:29ff:fe78:1023" 
    ##  [29] "192.168.202.103"                     
    ##  [30] "fe80::c62c:3ff:fe30:7333"            
    ##  [31] "fe80::4172:3555:4717:3e0c"           
    ##  [32] "192.168.203.61"                      
    ##  [33] "192.168.202.95"                      
    ##  [34] "192.168.204.70"                      
    ##  [35] "192.168.202.90"                      
    ##  [36] "192.168.203.62"                      
    ##  [37] "192.168.204.60"                      
    ##  [38] "192.168.202.83"                      
    ##  [39] "fe80::4c3a:e571:4cfc:b70c"           
    ##  [40] "2001:dbb:c18:202:b9ac:6976:ae1c:e10b"
    ##  [41] "192.168.202.75"                      
    ##  [42] "192.168.202.101"                     
    ##  [43] "2001:dbb:c18:203:226:18ff:fef9:be98" 
    ##  [44] "192.168.202.106"                     
    ##  [45] "fe80::a800:4ff:fe00:a04"             
    ##  [46] "2001:dbb:c18:202:a800:4ff:fe00:a04"  
    ##  [47] "fe80::d69a:20ff:fef9:b49c"           
    ##  [48] "fe80::f2de:f1ff:fe9b:ad6a"           
    ##  [49] "192.168.202.107"                     
    ##  [50] "2001:dbb:c18:204:a800:4ff:fe00:a04"  
    ##  [51] "192.168.202.110"                     
    ##  [52] "2001:dbb:c18:202:71f3:e219:3f6a:4311"
    ##  [53] "192.168.202.108"                     
    ##  [54] "192.168.202.96"                      
    ##  [55] "192.168.202.73"                      
    ##  [56] "192.168.202.112"                     
    ##  [57] "192.168.202.86"                      
    ##  [58] "fe80::62fb:42ff:feef:5440"           
    ##  [59] "192.168.28.103"                      
    ##  [60] "fe80::4c9b:aad8:8a6a:7bb0"           
    ##  [61] "192.168.202.113"                     
    ##  [62] "192.168.202.91"                      
    ##  [63] "fe80::65ca:c6cd:7ae0:ac8c"           
    ##  [64] "192.168.204.45"                      
    ##  [65] "192.168.203.45"                      
    ##  [66] "192.168.21.152"                      
    ##  [67] "192.168.21.103"                      
    ##  [68] "192.168.202.74"                      
    ##  [69] "192.168.23.152"                      
    ##  [70] "192.168.202.115"                     
    ##  [71] "192.168.24.152"                      
    ##  [72] "192.168.26.103"                      
    ##  [73] "192.168.202.116"                     
    ##  [74] "192.168.27.103"                      
    ##  [75] "192.168.27.25"                       
    ##  [76] "192.168.22.103"                      
    ##  [77] "192.168.27.102"                      
    ##  [78] "192.168.27.152"                      
    ##  [79] "192.168.27.202"                      
    ##  [80] "192.168.203.63"                      
    ##  [81] "192.168.22.152"                      
    ##  [82] "192.168.27.1"                        
    ##  [83] "192.168.27.253"                      
    ##  [84] "192.168.51.38"                       
    ##  [85] "192.168.27.203"                      
    ##  [86] "fe80::3e07:54ff:fe41:3ed3"           
    ##  [87] "192.168.27.254"                      
    ##  [88] "192.168.27.101"                      
    ##  [89] "192.168.203.64"                      
    ##  [90] "192.168.26.152"                      
    ##  [91] "192.168.27.100"                      
    ##  [92] "192.168.28.152"                      
    ##  [93] "192.168.24.25"                       
    ##  [94] "192.168.202.117"                     
    ##  [95] "192.168.202.63"                      
    ##  [96] "192.168.202.81"                      
    ##  [97] "192.168.22.1"                        
    ##  [98] "192.168.25.152"                      
    ##  [99] "128.244.172.252"                     
    ## [100] "192.168.22.253"                      
    ## [101] "192.168.22.252"                      
    ## [102] "192.168.22.102"                      
    ## [103] "192.168.22.254"                      
    ## [104] "192.168.22.101"                      
    ## [105] "192.168.22.100"                      
    ## [106] "192.168.22.25"                       
    ## [107] "192.168.25.25"                       
    ## [108] "10.10.117.209"                       
    ## [109] "192.168.229.252"                     
    ## [110] "192.168.28.25"                       
    ## [111] "192.168.26.25"                       
    ## [112] "192.168.23.25"                       
    ## [113] "192.168.202.49"                      
    ## [114] "192.168.202.119"                     
    ## [115] "192.168.202.118"                     
    ## [116] "10.10.117.210"                       
    ## [117] "192.168.202.120"                     
    ## [118] "fe80::9c8a:5786:bbb0:3db8"           
    ## [119] "192.168.0.199"                       
    ## [120] "192.168.202.121"                     
    ## [121] "172.16.6.57"                         
    ## [122] "192.168.202.109"                     
    ## [123] "192.168.202.122"                     
    ## [124] "192.168.208.18"                      
    ## [125] "192.168.202.123"                     
    ## [126] "192.168.23.101"                      
    ## [127] "192.168.23.103"                      
    ## [128] "192.168.23.100"                      
    ## [129] "192.168.21.25"                       
    ## [130] "169.254.228.26"                      
    ## [131] "192.168.229.101"                     
    ## [132] "192.168.229.1"                       
    ## [133] "192.168.229.156"                     
    ## [134] "192.168.229.153"                     
    ## [135] "192.168.229.251"                     
    ## [136] "192.168.229.254"                     
    ## [137] "192.168.25.254"                      
    ## [138] "192.168.202.124"                     
    ## [139] "2001:dbb:c18:202:4172:3555:4717:3e0c"
    ## [140] "2001:dbb:c18:202:d4bc:e39f:84ad:5001"
    ## [141] "192.168.28.1"                        
    ## [142] "192.168.28.101"                      
    ## [143] "192.168.28.253"                      
    ## [144] "192.168.28.102"                      
    ## [145] "10.10.10.10"                         
    ## [146] "192.168.202.125"                     
    ## [147] "192.168.28.254"                      
    ## [148] "192.168.21.1"                        
    ## [149] "192.168.21.100"                      
    ## [150] "192.168.21.102"                      
    ## [151] "192.168.21.203"                      
    ## [152] "192.168.22.202"                      
    ## [153] "192.168.22.203"                      
    ## [154] "192.168.21.253"                      
    ## [155] "192.168.21.202"                      
    ## [156] "192.168.21.254"                      
    ## [157] "192.168.28.202"                      
    ## [158] "192.168.23.1"                        
    ## [159] "192.168.23.102"                      
    ## [160] "192.168.202.126"                     
    ## [161] "fe80::20c:29ff:fe93:571e"            
    ## [162] "192.168.23.253"                      
    ## [163] "192.168.23.203"                      
    ## [164] "192.168.23.202"                      
    ## [165] "192.168.23.254"                      
    ## [166] "2001:dbb:c18:202:20c:29ff:fe93:571e" 
    ## [167] "192.168.202.98"                      
    ## [168] "192.168.202.68"                      
    ## [169] "192.168.202.128"                     
    ## [170] "fe80::62c5:47ff:fe93:381e"           
    ## [171] "192.168.202.129"                     
    ## [172] "fe80::ba8d:12ff:fe12:3f90"           
    ## [173] "192.168.202.4"                       
    ## [174] "192.168.202.130"                     
    ## [175] "192.168.202.131"                     
    ## [176] "192.168.202.132"                     
    ## [177] "192.168.202.133"                     
    ## [178] "192.168.21.252"                      
    ## [179] "192.168.24.1"                        
    ## [180] "192.168.25.1"                        
    ## [181] "192.168.202.134"                     
    ## [182] "fe80::3ed0:f8ff:fe34:4765"           
    ## [183] "192.168.24.254"                      
    ## [184] "192.168.24.103"                      
    ## [185] "192.168.24.252"                      
    ## [186] "192.168.202.135"                     
    ## [187] "169.254.109.123"                     
    ## [188] "192.168.95.166"                      
    ## [189] "fe80::423c:fcff:fe06:98a4"           
    ## [190] "192.168.202.64"                      
    ## [191] "192.168.207.58"                      
    ## [192] "192.168.202.137"                     
    ## [193] "192.168.202.138"                     
    ## [194] "192.168.202.139"                     
    ## [195] "192.168.202.140"                     
    ## [196] "192.168.203.66"                      
    ## [197] "192.168.202.62"                      
    ## [198] "fe80::bc5c:15c1:ec81:1e08"           
    ## [199] "192.168.202.141"                     
    ## [200] "2001:dbb:c18:202:bc5c:15c1:ec81:1e08"
    ## [201] "2001:dbb:c18:202:9c6b:be4e:1289:2663"
    ## [202] "192.168.0.3"                         
    ## [203] "192.168.204.71"                      
    ## [204] "192.168.202.67"                      
    ## [205] "192.168.202.136"                     
    ## [206] "192.168.204.72"                      
    ## [207] "192.168.202.143"                     
    ## [208] "192.168.202.144"                     
    ## [209] "2001:dbb:c18:202:d557:eac5:3728:41ee"
    ## [210] "2001:dbb:c18:202:4c3a:e571:4cfc:b70c"
    ## [211] "192.168.202.145"                     
    ## [212] "128.244.37.196"                      
    ## [213] "172.16.10.130"                       
    ## [214] "192.168.202.146"                     
    ## [215] "fe80::88f4:9f4d:feec:8072"           
    ## [216] "192.168.202.147"                     
    ## [217] "2001:dbb:c18:202:a1dd:6355:28ae:da1e"
    ## [218] "fe80::11a:f507:d853:a03d"            
    ## [219] "2001:dbb:c18:202:20c:29ff:fe41:4be7" 
    ## [220] "172.16.42.42"                        
    ## [221] "192.168.202.240"                     
    ## [222] "192.168.202.222"                     
    ## [223] "fe80::20c:29ff:fe41:4be7"            
    ## [224] "192.168.26.1"                        
    ## [225] "192.168.25.100"                      
    ## [226] "192.168.25.101"                      
    ## [227] "192.168.24.102"                      
    ## [228] "192.168.25.102"                      
    ## [229] "192.168.25.103"                      
    ## [230] "192.168.24.253"                      
    ## [231] "192.168.202.148"                     
    ## [232] "192.168.25.253"                      
    ## [233] "192.168.24.203"                      
    ## [234] "192.168.24.202"                      
    ## [235] "192.168.23.252"                      
    ## [236] "192.168.25.203"                      
    ## [237] "192.168.25.202"                      
    ## [238] "192.168.26.254"                      
    ## [239] "192.168.202.149"                     
    ## [240] "192.168.202.150"                     
    ## [241] "192.168.100.130"                     
    ## [242] "192.168.202.151"                     
    ## [243] "192.168.202.152"                     
    ## [244] "192.168.202.33"                      
    ## [245] "192.168.202.153"                     
    ## [246] "192.168.202.154"                     
    ## [247] "fe80::216:d3ff:fe4b:70d"             
    ## [248] "2001:dbb:c18:202:216:d3ff:fe4b:70d"  
    ## [249] "192.168.202.156"                     
    ## [250] "fe80::d840:5635:ef48:b032"           
    ## [251] "192.168.202.157"                     
    ## [252] "2001:dbb:c18:202:6128:bec8:28c6:8c7b"
    ## [253] "192.168.202.155"

    resp_ip<-unique(inf$`resp_ip `)
    all_ip<-merge(orig_ip,resp_ip)
    NROW(unique(all_ip$`x`))

    ## [1] 253

## 5. Какое соотношение участников обмена внутри сети и участников обращений к внешним ресурсам?

## 6. Найдите топ-10 участников сети, проявляющих наибольшую сетевую активность.

    m1<-inf%>%
    count(inf$`orig_ip `,sort=TRUE)
    colnames(m1) <- c("Person", "count")
    m2<-inf%>%
    count(inf$`resp_ip `,sort=TRUE)
    colnames(m2) <- c("Person", "count")
    mm<-rbind(m1,m2)
    mm<-mm %>%
      group_by(Person) %>%
      summarise(count)

    ## `summarise()` has grouped output by 'Person'. You can override using the
    ## `.groups` argument.

    mm<-mm[order(mm$Person, decreasing = TRUE), ]   
    mm

    ## # A tibble: 1,483 × 2
    ## # Groups:   Person [1,359]
    ##    Person                    count
    ##    <chr>                     <int>
    ##  1 ff02::fb                   3298
    ##  2 ff02::1:3                 14411
    ##  3 fec0:0:0:ffff::3             44
    ##  4 fec0:0:0:ffff::2             47
    ##  5 fec0:0:0:ffff::1             47
    ##  6 fe80::f2de:f1ff:fe9b:ad6a    30
    ##  7 fe80::d840:5635:ef48:b032   276
    ##  8 fe80::d69a:20ff:fef9:b49c   141
    ##  9 fe80::d69a:20ff:fef9:b49c     2
    ## 10 fe80::c62c:3ff:fe37:efc     126
    ## # … with 1,473 more rows

## 7. Найдите топ-10 доменов, к которым обращаются пользователи сети и соответственное количество обращений

## 8. Опеределите базовые статистические характеристики (функция summary()) интервала времени между последовательным обращениями к топ-10 доменам.

## 9. Часто вредоносное программное обеспечение использует DNS канал в качестве канала управления, периодически отправляя запросы на подконтрольный злоумышленникам DNS сервер. По периодическим запросам на один и тот же домен можно выявить скрытый DNS канал. Есть ли такие IP адреса в исследуемом датасете?

## Обогащение данных 10. Определите местоположение (страну, город) и организацию-провайдера для топ-10 доменов. Для этого можно использовать сторонние сервисы, например <https://v4.ifconfig.co/>.
